---
layout: publication
title: 'A3 : An Analytical Low-rank Approximation Framework For Attention'
authors: Jeffrey T. H. Wong, Cheng Zhang, Xinye Cao, Pedro Gimenes, George A. Constantinides, Wayne Luk, Yiren Zhao
conference: "Arxiv"
year: 2025
bibkey: wong2025analytical
additional_links:
  - {name: "Paper", url: "https://arxiv.org/abs/2505.12942"}
tags: ['Efficiency and Optimization', 'Training Techniques', 'Model Architecture', 'Tools', 'Pruning', 'Quantization', 'Pretraining Methods', 'Transformer', 'Attention Mechanism']
---
Large language models have demonstrated remarkable performance; however, their massive parameter counts make deployment highly expensive. Low-rank approximation offers a promising compression solution, yet existing approaches have two main limitations: (1) They focus on minimizing the output error of individual linear layers, without considering the architectural characteristics of Transformers, and (2) they decompose a large weight matrix into two small low-rank matrices. Consequently, these methods often fall short compared to other compression techniques like pruning and quantization, and introduce runtime overhead such as the extra GEMM kernel launches for decomposed small matrices. To address these limitations, we propose \\(\tt A^\tt 3\\), a post-training low-rank approximation framework. \\(\tt A^\tt 3\\) splits a Transformer layer into three functional components, namely \\(\tt QK\\), \\(\tt OV\\), and \\(\tt MLP\\). For each component, \\(\tt A^\tt 3\\) provides an analytical solution that reduces the hidden dimension size inside each component while minimizing the component's functional loss (\\(\it i.e.\\), error in attention scores, attention outputs, and MLP outputs). This approach directly reduces model sizes, KV cache sizes, and FLOPs without introducing any runtime overheads. In addition, it provides a new narrative in advancing the optimization problem from singular linear layer loss optimization toward improved end-to-end performance. Through extensive experiments, we show that \\(\tt A^\tt 3\\) maintains superior performance compared to SoTAs. For example, under the same reduction budget in computation and memory, our low-rank approximated LLaMA 3.1-70B achieves a perplexity of 4.69 on WikiText-2, outperforming the previous SoTA's 7.87 by 3.18. We also demonstrate the versatility of \\(\tt A^\tt 3\\), including KV cache compression, quantization, and mixed-rank assignments for enhanced performance.
