---
layout: publication
title: 'R-bot: An Llm-based Query Rewrite System'
authors: Zhaoyan Sun, Xuanhe Zhou, Guoliang Li
conference: "Arxiv"
year: 2024
bibkey: sun2024r
additional_links:
  - {name: "Paper", url: 'https://arxiv.org/abs/2412.01661'}
tags: ['RAG', 'Efficiency and Optimization', 'Security', 'GPT', 'Model Architecture']
---
Query rewrite is essential for optimizing SQL queries to improve their
execution efficiency without changing their results. Traditionally, this task
has been tackled through heuristic and learning-based methods, each with its
limitations in terms of inferior quality and low robustness. Recent
advancements in LLMs offer a new paradigm by leveraging their superior natural
language and code comprehension abilities. Despite their potential, directly
applying LLMs like GPT-4 has faced challenges due to problems such as
hallucinations, where the model might generate inaccurate or irrelevant
results. To address this, we propose R-Bot, an LLM-based query rewrite system
with a systematic approach. We first design a multi-source rewrite evidence
preparation pipeline to generate query rewrite evidences for guiding LLMs to
avoid hallucinations. We then propose a hybrid structure-semantics retrieval
method that combines structural and semantic analysis to retrieve the most
relevant rewrite evidences for effectively answering an online query. We next
propose a step-by-step LLM rewrite method that iteratively leverages the
retrieved evidences to select and arrange rewrite rules with self-reflection.
We conduct comprehensive experiments on widely used benchmarks, and demonstrate
the superior performance of our system, R-Bot, surpassing state-of-the-art
query rewrite methods.
